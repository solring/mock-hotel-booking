{"version":3,"sources":["utils/utils.js","components/order/OrderDetail.js","pages/Order.js"],"names":["genGuestStr","adult","child","room","items","push","join","OrderDetail","props","orders","useState","collapseOn","setCollapseOn","collapsed","subtotal","length","map","item","number","price","night","reduce","a","b","vat","Math","round","serviceCharge","total","formatDate","longStr","dayjs","format","TitleBtn","className","onClick","Collapse","in","order","i","startDate","endDate","hotel","OrderPage","name","setName","email","setEmail","phone","setPhone","validating","setValidating","fields","useSelector","state","cart","status","globalDispatch","useDispatch","doReserve","e","preventDefault","target","checkValidity","AJAX_STATUES_LOADING","submitOrder","res","console","log","payload","window","location","href","CONFIRMATION","qs","stringify","Form","onSubmit","noValidate","short","title","type","reactValue","reactSet","htmlFor","id","required","value","onChange","failMsg","Content","Loading","AJAX_STATUES_FAILED","Layout","Header","simple","member","Footer"],"mappings":"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","file":"static/js/11.073c0dbf.chunk.js","sourcesContent":["export function genGuestStr(adult, child, room) {\n\n  let items = [];\n  if (adult) {\n    if (adult === 1) items.push(\"1 adult\");\n    else if (adult > 1) items.push(`${adult} adults`);\n  }\n\n  if (child) {\n    if (child === 1) items.push(\"1 child\");\n    else if (child > 1) items.push(`${child} children`);\n  }\n\n  if (room) {\n    if (room === 1) items.push(\"1 room\");\n    else if (room > 1) items.push(`${room} rooms`);\n  }\n\n  return items.join(\"・\");\n}","import PropTypes from 'prop-types'\n\nimport { useState } from 'react';\nimport { Collapse } from 'react-bootstrap';\n\nimport { genGuestStr } from '../../utils/utils';\nimport dayjs from 'dayjs';\n\nfunction OrderDetail(props) {\n  const { orders } = props;\n  const [ collapseOn, setCollapseOn] = useState(false);\n\n  let collapsed = collapseOn ? \"\" : \"collapsed\";\n  let subtotal = orders && orders.length > 0 ?\n    orders.map((item) => item.number * item.price * item.night).reduce((a, b) => a+b, 0) :\n    0;\n  let vat = Math.round(subtotal * 0.07);\n  let serviceCharge = Math.round(subtotal * 0.1);\n  let total = subtotal + vat + serviceCharge;\n\n  const formatDate = (longStr) => {\n    return dayjs(longStr).format('DD MMMM');\n  }\n\n  const TitleBtn = (props) => (\n    <a className={`p-3 d-block d-md-none ${collapsed}`} onClick={() => setCollapseOn(!collapseOn)}>\n      <div className=\"d-flex justify-content-between\">\n        <p className=\"text-dark animate-title-fadeout\">\n          <span className=\"text-sub text-secondary mr-3\">Total</span>\n          <span className=\"font-weight-bold\">TWD {total}</span>\n        </p>\n        <p className=\"text-primary text-uppercase font-weight-bold\">\n          Detail\n          <span className=\"material-icons icon-lg animate-icon animate-icon-spin\">keyboard_arrow_up</span>\n        </p>\n      </div>\n    </a>\n  );\n\n  return (\n<div className=\"card rounded-lg-up-md bg-info\">\n  <TitleBtn />\n  <Collapse in={collapseOn} className=\"Order__detail bg-info w-100 collapse-absolute collapse-disabled-md\">\n    <div> {/* essential for current react-bootstrap collapse */}\n    <ul className=\"list-unstyled list-divider-white py-3 py-md-4 mx-3 mx-md-4 rounded-bottom border-top border-light\">\n      <li key=\"detail\">\n        <h6 className=\"mb-3\">Booking details</h6>\n        <ul className=\"list-unstyled list-divider-white\">\n          {orders && orders.map((order, i) => (\n            <li className=\"mb-3\" key={i}>\n              <p className=\"text-sub text-secondary\">{formatDate(order.startDate)} - {formatDate(order.endDate)}・{order.night} night(s)</p>\n              <p className=\"text-sub text-secondary\">{genGuestStr(order.adult, order.child, order.room)}</p>\n              <p className=\"text-sub text-secondary\">{order.hotel}</p>\n              <p className=\"text-sub text-secondary\">{order.room}</p>\n            </li>\n          ))}\n        </ul>\n      </li>\n      <li key=\"price\">\n        <h6 className=\"mb-3\">Price summary</h6>\n        <ul className=\"list-unstyled\">\n          {orders && orders.map((item, i) => (\n            <li key={i} className=\"d-flex justify-content-between\">\n              <p className=\"text-sub text-secondary\">{item.room}</p>\n              <p className=\"text-sub text-secondary\">\n                TWD {item.price * item.number * item.night}\n              </p>\n            </li>\n          ))}\n          <li key=\"vat\" className=\"d-flex justify-content-between\">\n            <p className=\"text-sub text-secondary\">VAT(7%)</p>\n            <p className=\"text-sub text-secondary\">\n              TWD {vat}\n            </p>\n          </li>\n          <li key=\"serviceCharge\" className=\"d-flex justify-content-between\">\n            <p className=\"text-sub text-secondary\">Property service charge</p>\n            <p className=\"text-sub text-secondary\">\n              TWD {serviceCharge}\n            </p>\n          </li>\n        </ul>\n      </li>\n      <li key=\"total\" className=\"d-flex justify-content-between\">\n        <p className=\"text-sub text-secondary\">Total</p>\n        <p className=\"font-weight-bold\">TWD {total}</p>\n      </li>\n    </ul>\n    </div>\n  </Collapse>\n</div>\n  )\n}\n\nOrderDetail.propTypes = {\n  orders: PropTypes.arrayOf(\n    PropTypes.shape({\n      hotel: PropTypes.string.isRequired,\n      room: PropTypes.string.isRequired,\n      number: PropTypes.number.isRequired,\n      price: PropTypes.number.isRequired,\n      startDate: PropTypes.string.isRequired,\n      endDate: PropTypes.string.isRequired,\n      adult: PropTypes.number.isRequired,\n      child: PropTypes.number.isRequired,\n      night: PropTypes.number.isRequired,\n    }),\n  ),\n}\n\nexport default OrderDetail;","import { useState } from 'react';\nimport qs from 'query-string';\nimport Layout from '../layout/Layout';\n\nimport Header from '../components/Header/Header';\nimport Footer from '../components/Footer';\nimport Loading from '../components/Loading';\nimport OrderDetail from '../components/order/OrderDetail';\n\nimport { useSelector, useDispatch } from 'react-redux'\nimport { submitOrder } from '../features/cartSlicer';\nimport {\n  AJAX_STATUES_LOADING,\n  AJAX_STATUES_FAILED,\n} from '../features/fetchStatus';\n\nimport { CONFIRMATION } from '../utils/links';\n\nfunction OrderPage(props){\n\n  const [name, setName] = useState(\"\");\n  const [email, setEmail]  = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [validating, setValidating] = useState(\"\");\n\n  const fields = [\n    [\"name\", \"Name\", \"text\", name, setName],\n    [\"email\", \"Email\", \"email\", email, setEmail],\n    [\"phone\", \"Phone (optional)\", \"tel\", phone, setPhone],\n  ];\n\n  // redux\n  const orders = useSelector(state => state.cart.orders);\n  const status = useSelector(state => state.cart.status);\n  const globalDispatch = useDispatch();\n\n  const doReserve = async (e) => {\n    e.preventDefault();\n    setValidating('was-validated');\n\n    if(e.target.checkValidity() === false) return;\n\n    if(status !== AJAX_STATUES_LOADING) {\n      let res = await globalDispatch(submitOrder(orders))\n      console.log(res);\n      if(res.payload.order)\n        window.location.href = CONFIRMATION + \"?\" + qs.stringify({order: res.payload.order});\n    }\n  }\n\n  const Form = (\n    <form className={validating} onSubmit={doReserve} noValidate>\n      <h2 className=\"mb-4 mt-4 mt-md-0\">Reservation Details</h2>\n      <ul className=\"list-unstyled text-secondary\">\n        {fields.map(([short, title, type, reactValue, reactSet]) => (\n          <li key={short} className=\"form-group\">\n            <label htmlFor={short}>{title}</label>\n            <input id={short} name={short} type={type}\n              className=\"form-control form-control-lg\"\n              required={(short === 'phone') ? false : true}\n              value={reactValue} onChange={(e) => reactSet(e.target.value)}\n            />\n          </li>\n        ))}\n      </ul>\n      <button className=\"btn btn-lg btn-primary btn-block text-uppercase mt-4\" type=\"submit\">reserve</button>\n      <a href=\"#\" className=\"d-block text-center text-sub mt-2\">Reserve now, pay at stay</a>\n    </form>\n  );\n\n  const failMsg = (\n    <div className=\"alert alert-danger mt-4\">\n      Oops! There is something wrong with the server. Please submit later.\n    </div>\n  );\n\n  const Content = (\n  <div className=\"container pt-0 pt-md-4\">\n  <div className=\"row no-gutters justify-content-center\">\n    <div className=\"col-lg-8\">\n\n      <div className=\"row flex-md-row-reverse\">\n        <div className=\"col-md-6 px-0 px-sm-3\">\n\n          <OrderDetail orders={orders}/>\n        </div>\n        <div className=\"col-md-6 mb-5\">\n          {status === AJAX_STATUES_LOADING ?  <Loading /> : Form }\n          {status === AJAX_STATUES_FAILED && failMsg}\n        </div>\n      </div>\n\n    </div>\n  </div>\n  </div>\n  );\n\n  return (\n    <Layout>\n      <Layout.Header>\n        <Header simple={false} member={false} />\n      </Layout.Header>\n      <Layout.Content>\n        {Content}\n      </Layout.Content>\n      <Footer short={true} />\n    </Layout>\n  );\n}\n\nexport default OrderPage;"],"sourceRoot":""}